### 42 $\textit{pimpleFoam}$

$\textit{pimpleFoam}$ 是一个使用PIMPLE算法的瞬态不可压缩求解器。PIMPLE算法是PISO和SIMPLE的组合。该求解器在文件$\text{pimpleFoam.C}$中描述如下。

```
使用PIMPLE（合并的PISO-SIMPLE）算法对不可压缩的流进行求解的大时间步长瞬态求解器。

湍流模型是通用的，即可以选择层流、RAS或LES。
```

#### 42.1 控制方程

##### 42.1.1 连续性方程

一般的连续性方程具有以下形式：

<p>
$$
\frac{\partial\rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0
\tag{64}
$$
</p>

我们假设流体不可压缩：$\rho = const$

<p>
$$
\nabla \cdot \mathbf{u} = 0
\tag{65}
$$
</p>

或者使用其他形式

<p>
$$
div(\mathbf{u}) = 0
\tag{66}
$$
</p>
<p>
$$
\frac{u_i}{x_i} = 0
\tag{67}
$$
</p>

##### 42.1.2 动量方程

从纳维-斯托克斯方程出发，得出$\text{pimpleFoam}$的动量方程。

<p>
$$
\frac{\partial \rho \mathbf{u}}{\partial t} + \nabla (\rho \mathbf{u} \mathbf{u}) + \nabla \cdot \tau = -\nabla p + \mathbf{g}= 0
\tag{68}
$$
</p>

我们假设密度为常数，方程两边同除以$\rho$

<p>
$$
\frac{\partial \mathbf{u}}{\partial t} + \nabla (\mathbf{u} \mathbf{u}) + \frac{1}{\rho}\nabla \cdot \tau = -\frac{\nabla p}{\rho} + \frac{\mathbf{g}}{\rho}
\tag{69}
$$
</p>

最后一项定义成一般源项

<p>
$$
\frac{\partial \mathbf{u}}{\partial t} + \nabla (\mathbf{u} \mathbf{u}) + \frac{1}{\rho}\nabla \cdot \tau = -\frac{\nabla p}{\rho} + \mathbf{Q}
\tag{70}
$$
</p>

切向应力和压力用新符号表示：$\frac{\tau}{\rho} = \mathbf{R}^{eff}\text{ und } \frac{p}{\rho}=p$

<p>
$$
\frac{\partial \mathbf{u}}{\partial t} + \nabla (\mathbf{u} \mathbf{u}) + \nabla \cdot \mathbf{R}^{eff} = -\frac{\nabla p}{\rho} + \mathbf{Q}
\tag{71}
$$
</p>

Boussinesq假说允许我们给切向应力加上雷诺应力。这个切向应力—也就是同时包含切向应力与雷诺应力—这里被写做$\mathbf{R}^{eff}$，也就是有效应力张量。 RAS和LES湍流模型都基于Boussinesq假设。

<p>
$$
\mathbf{R}^{eff} = -\nu^{eff}(\nabla \mathbf{u} + (\nabla \mathbf{u})^T)
\tag{72}
$$
</p>

<p>
$$
R_{ij}^{eff} = -\nu^{eff}(\frac{u_i}{x_j} + \frac{u_j}{x_i})
\tag{73}
$$
</p>

$\tau$的迹满足不可压缩流的连续性方程

<p>
$$
tr(\mathbf{R}^{eff}) = -2\nu^{eff}(\frac{u_i}{x_i})=0
\tag{74}
$$
</p>

<p>
$$
\frac{u_i}{x_i} = \nabla \cdot \mathbf{u} =0
\tag{75}
$$
</p>

因此，我们可以用$\mathbf{R}^{eff}$偏应力部分替代$\mathbf{R}^{eff}$

<p>
$$
\mathbf{R}^{eff} = \underbrace{dev(\mathbf{R}^{eff})}_{偏应力张量} + \underbrace{\frac{1}{3} tr (\mathbf{R}^{eff})\mathbf{I}}_{静水应力张量} 
\tag{76}
$$
</p>

<p>
$$
dev(\mathbf{R}^{eff}) = \mathbf{R}^{eff} - \frac{1}{3} \underbrace{tr (\mathbf{R}^{eff})}_{=0}\mathbf{I} 
\tag{77}
$$
</p>

动量方程可以被改写为

<p>
$$
\frac{\partial \mathbf{u}}{\partial t} + \nabla (\mathbf{u} \mathbf{u}) + \underbrace{\nabla \cdot (dev(\mathbf{R}^{eff}))}_{=div(dev(\mathbf{R}^{eff}))} = -\frac{\nabla p}{\rho} + \mathbf{Q}
\tag{78}
$$
</p>

带入方程72，最终可以得到

<p>
$$
\frac{\partial \mathbf{u}}{\partial t} + \nabla (\mathbf{u} \mathbf{u}) + \nabla \cdot (dev(-\nu^{eff}(\nabla \mathbf{u} + (\nabla \mathbf{u})^T)))= -\frac{\nabla p}{\rho} + \mathbf{Q}
\tag{79}
$$
</p>

##### 42.1.3 实现

动量方程实现在$\text{UEqn.H}$这个文件中。方程79的前两项可以很容易的在代码列表263中读出。

其中第一项是动量的局部导数—由于流体不可压缩，密度不包含在项内—位于列表263的第5行。这里，源代码中的指令与数学符号的读法非常一致。

<p>
$$
\frac{\partial \mathbf{u}}{\partial t}\qquad \Leftrightarrow\qquad \text{fvm::ddt(U)}
$$
</p>

方程79的第二项描述了动量的对流输运。标识符$\text{phi}$不应该导致混淆。为了方便从源代码中读取方程，这里可以用$\text{U}$代替$\text{phi}$，其并不改变方程的含义。源代码中为什么使用$\text{phi}$与求解过程有关。关于$\text{phi}$的详细讨论见第63节。

<p>
$$
\underbrace{\nabla(\mathbf{u}\mathbf{u})}_{div (\mathbf{u}\mathbf{u})} \qquad \Leftrightarrow \qquad \text{fvm::div(phi, U)}
$$
</p>

第三项代表的是动量扩散传输项。动量扩散传输是由层流黏度和湍流引起的。因此，由湍流模型处理这个项。见代码列表263的第7行。

<p>
$$
\underbrace{\nabla\cdot(dev(\mathbf{R}^{eff}))}_{=div(dev(\mathbf{R}^{eff})} \qquad \Leftrightarrow \qquad \text{turbulence->divDevReff(U)}
$$
</p>

方程79的右边两项分别代表压力梯度和源项。

<p>
$$
\underbrace{-\nabla p}_{=-grad\ p} \qquad \Leftrightarrow \qquad \text{-fvc::grad(p))}
$$
</p>

<p>
$$
\mathbf{Q} \qquad \Leftrightarrow \qquad \text{sources(U)}
$$
</p>

```
tmp <fvVectorMatrix > UEqn 
(
    fvm::ddt(U) 
    + fvm::div(phi , U) 
    + turbulence ->divDevReff(U) 
); 

UEqn().relax(); 

sources.constrain(UEqn());

volScalarField rAU (1.0/ UEqn().A()); 

if (pimple.momentumPredictor ())
{ 
    solve(UEqn() == -fvc::grad(p) + sources(U)); 
}
```
列表 263：$\text{pimpleFom}$的$\text{UEqn.H}$文件


