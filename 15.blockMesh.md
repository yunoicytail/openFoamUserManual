### 15 blockMesh

_blockMesh_ 用来创建网格。几何体是在 _blockMeshDict_ 中定义的。这个文件中也包括所有的创建网格的必要参数，例如单元数量。因此， _blockMesh_ 是一个可以定义几何体及为几何体生成网格的组合工具，与其他网格软件通过导入CAD文件来生成网格相比较。

#### 15.1 block

_blockMesh_ 创建的几何体基于通用六面体块，图7所示为一个方块。

![通用块](images/6.PNG)

图中，蓝色数字代表块的顶点数字，顶点在x-y平面逆时针编号，以当地坐标原点作为起点，接着高于x-y平面的顶点以位于z轴上的顶点作为起点逆时针编号。

当地顶点编号数字对块的定义很重要。blockMeshDict的第一个部分通常是顶点的列表。根据这些顶点构建块，块需要按照匹配当地顶点的顺序由列表中的8各顶点来定义。因此顶点列表的第一个入口就是当地0号顶点，然乎紧跟1号顶点。当地顶点的编号定义了依次传递构建块的顺序。

以0号顶点起始的坐标系称为当地坐标，在确认单元数量或网格级别的时候当地坐标是很重要的（详见15.4节 _simpleGrading_ ）。当地坐标轴不需要和全局坐标轴平行。

块的边也编号并有方向性，首先从平行于x轴的边开始编号，并以从原点发出的边起始逆时针依次编号，接着是平行于y轴的边，最后是平行于z轴的边。在确认每条边的级别时边的编号很重要（详见15.4节 _edgeGrading_ ）。

由图7所示，块的边并不需要平行或是直线。15.2.4节讨论了如何定义曲线边。

#### 15.2 blockMeshDict

 _blockMeshDict_ 文件定义和控制 _blockMesh_ 的网格进程。列表84展示了blockMeshDict的简易版例子，文件来自帮助案例 _cavity_ 。


```
FoamFile
{
    vesion    2.0;
    format    ascii;
    class     dictionary;
    object    blockMehsDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

convertToMeters 0.1;

vertices
(
    (0 0 0)    //0
   （0 0 0.1） //1
    ...
);

blocks
(
   hex (0 1 2 3 4 5 6 7) (20 20 1) simpleGrading (1 1 1)
);

edges
(
);

boundary
(
    movingWall
    {
        type wall;
        faces
        (
            (3 7 6 2)
        );
    }
    ...
);

mergePatchPairs
(
);

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
```
列表84：一个最小blockMeshDict文件


#### 15.2.1 convertToMeters

 _convertToMeters _ 是一个尺度因子，可以将 _blockMeshDict_ 的顶点坐标转化成米制单位，如果顶点坐标输入时不是以米为单位，尺度因子的值就需要根据情况来修改。列表85展示如果顶点坐标以毫米单位输入时应如何设置。


```
convertToMeters 0.001;
```
列表85：convertToMeters

如果在blockMehsDict丢失了关键字convertToMeters，就不会缩放，默认值为1。

为确认是否使用了缩放因子，blockMesh的输出会进行检查。列表86显示了考虑了convertToMeters定义的缩放因子后blockMesh提示的信息。

```
Creating points with scale 0.1
```
列表86：convertToMeters设置为0.1时blockMesh的输出

 **convertToMesh** 是一个均匀统一的收缩因子，可以使用其他工具进行非均匀的缩放。见27.1和29.3.4节。

#### 15.2.2 顶点

 **vertices** 是包含顶点列表的子字典。每个顶点由它在全局坐标系的坐标来定义。OpenFOAM默认这些坐标单位都是米。然而，有了关键字 **convertToMeters** 可以以其他单位来指定。

某个顶点在列表中的索引值也是顶点的全局编号，这个编号在构建块的时候会用到。记住，从0开始计数，因此第一个顶点地址为0，一个提醒自己这种方式的方法是在顶点列表添加注释，例如列表84。


#### 15.2.3 块

在 **blocks** 子字典中唯一有效的入口是 **hex** 关键字。