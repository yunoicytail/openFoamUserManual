### 48 driftFluxFoam
*driftFluxFoam* is a solver of OpenFOAM to simulate e.g. settling of disperse particles in a liquid. driftFluxFoam is the successor of settlingFoam, which has been discontinued with the release of OpenFOAM-2.3.1138.
*driftFluxFoam*æ˜¯OpenFOAMçš„ä¸€ä¸ªæ±‚è§£å™¨ï¼Œç”¨äºæ¨¡æ‹Ÿåˆ†æ•£ç²’å­åœ¨æ¶²ä½“ä¸­çš„æ²‰é™ã€‚driftFluxFoamæ˜¯åœ¨settlingFoamçš„åŸºç¡€ä¸Šå‘å±•èµ·æ¥çš„ï¼Œéšç€OpenFOAM-2.3.1138çš„å‘å¸ƒï¼ŒsettlingFoamå·²ç»åœæ­¢äº†ä½¿ç”¨ã€‚

*settlingFoam* was used by Brennan [12] in his thesis, which contains a lot of information on deriving the drift flux model from the Eulerian two-fluid model equations. The header of driftFluxFoam describes this solver as follows:
*Brennan[12]åœ¨ä»–çš„è®ºæ–‡ä¸­ä½¿ç”¨äº†settlingFoamï¼Œå…¶ä¸­åŒ…å«äº†ä»æ¬§æ‹‰åŒæµä½“æ¨¡å‹æ–¹ç¨‹æ¨å¯¼æ¼‚ç§»é€šé‡æ¨¡å‹çš„å¤§é‡ä¿¡æ¯ã€‚driftFluxFoamçš„å¤´æ–‡ä»¶å°†æ­¤æ±‚è§£å™¨æè¿°å¦‚ä¸‹ï¼š
	Solver for 2 incompressible fluids using the mixture approach with the drift-flux approximation for relative motion of the phases.
	Used for simulating the settling of the dispersed phase and other similar separation problems.
	æ±‚è§£2ä¸ªä¸å¯å‹ç¼©æµä½“çš„æ··åˆæ–¹æ³•å’Œç›¸å¯¹è¿åŠ¨ç›¸çš„æ¼‚ç§»é€šé‡è¿‘ä¼¼ã€‚
	ç”¨äºæ¨¡æ‹Ÿåˆ†æ•£ç›¸çš„æ²‰é™å’Œå…¶å®ƒç±»ä¼¼çš„åˆ†ç¦»é—®é¢˜ã€‚
*driftFluxFoam* complys with the generic solver design of OpenFOAM, thus this solver can use all available turbulence models. It also can use the MRF method and the fvOptions framework.
*FloftFluxFoam*ä¸OpenFOAMçš„é€šç”¨è§£ç®—å™¨è®¾è®¡å…¼å®¹ï¼Œå› æ­¤è¯¥è§£ç®—å™¨å¯ä»¥ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„æ¹æµæ¨¡å‹ã€‚å®ƒè¿˜å¯ä»¥ä½¿ç”¨MRFæ–¹æ³•å’ŒfvOptionsæ¡†æ¶ã€‚

#### 48.1 Governing equations æ§åˆ¶æ–¹ç¨‹
The governing equations for the mixture are derived from the two-fluid model [12, 31].
åˆç‰©çš„æ§åˆ¶æ–¹ç¨‹ç”±åŒæµä½“æ¨¡å‹å¯¼å‡º[12ï¼Œ31]ã€‚

##### 48.1.1 Mixture continuity equation æ··åˆè¿ç»­æ–¹ç¨‹
The mixture continuity equation can be easily derived by adding the continuity equations of the two phases:
é€šè¿‡å°†ä¸¤ç›¸çš„è¿ç»­æ€§æ–¹ç¨‹ç›¸åŠ ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°å¯¼å‡ºæ··åˆè¿ç»­æ€§æ–¹ç¨‹ï¼š
(129)
with the constitutive relations
å†ç»“åˆæœ¬æ„å…³ç³»
(130)
(131)
we gain
æˆ‘ä»¬å¯ä»¥å¾—åˆ°
(132)
##### 48.1.2 Mixture momentum equation æ··åˆåŠ¨é‡æ–¹ç¨‹
**Derivation from literature**
åŸºäºæ–‡çŒ®æ¨å¯¼
The derivation of the mixture momentum equation is analogous to the derivation of the mixture continuity equation. Therefore, we skip the general derivation and refer the interested reader to the appropriate literature [12, 31]. In this section, we want to focus on the derivation of the specific equations implemented in driftFluxFoam.
We start from the derivation given in the appendix of Brennan [12]:

æ··åˆåŠ¨é‡æ–¹ç¨‹çš„æ¨å¯¼ç±»ä¼¼äºæ··åˆè¿ç»­æ€§æ–¹ç¨‹çš„æ¨å¯¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è·³è¿‡ä¸€èˆ¬çš„æ¨å¯¼ï¼Œè®©æ„Ÿå…´è¶£çš„è¯»è€…å‚è€ƒé€‚å½“çš„æ–‡çŒ®[12ï¼Œ31]ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»åœ¨driftFluxFoamä¸­å®ç°çš„ç‰¹å®šæ–¹ç¨‹çš„æ¨å¯¼ã€‚

æˆ‘ä»¬ä»å¸ƒä¼¦å—[12]é™„å½•ä¸­ç»™å‡ºçš„æ¨å¯¼å¼€å§‹ï¼š

(133)
we pay special attention to the diffusion stress ********PÎ±kÏkukmukm********, which represents momentum diffusion due to the relative motion between the phases.
æˆ‘ä»¬ç‰¹åˆ«æ³¨æ„æ‰©æ•£åº”åŠ›******PÎ±kÏkukmukm******ï¼Œå®ƒè¡¨ç¤ºç”±äºç›¸ä¹‹é—´çš„ç›¸å¯¹è¿åŠ¨è€Œäº§ç”Ÿçš„åŠ¨é‡æ‰©æ•£ã€‚
(134)
For convenience we introduce the symbol Ï„dm for the diffusion stress
ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å¼•å…¥ç¬¦å·Ï„dmè¡¨ç¤ºæ‰©æ•£åº”åŠ›
Ï„dm = XÎ±kÏkukmukm (135)
with ukm, the velocity of the phase k relative to the mixtureâ€™s centre of mass; ukm is also referred to as diffusion velocity of the phase k 
ç”¨ukmè¡¨ç¤ºkç›¸ç›¸å¯¹äºæ··åˆç‰©è´¨å¿ƒçš„é€Ÿåº¦ï¼›ukmä¹Ÿç§°ä¸ºkç›¸çš„æ‰©æ•£é€Ÿåº¦
ukm = uk âˆ’ um (136)
Ishii and Hibiki [31] states a relation between the diffusion velocities of the two phases:
Ishiiå’ŒHibiki[31]æŒ‡å‡ºäº†ä¸¤ç›¸æ‰©æ•£é€Ÿåº¦ä¹‹é—´çš„å…³ç³»ï¼š
Î±1Ï1u1m + Î±2Ï2u2m = 0 (137)
Thus, we can eliminate u1m from the diffusion stress Ï„dm
å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ‰©æ•£åº”åŠ›Ï„dmä¸­æ¶ˆé™¤u1m
Ï„dm = Î±1Ï1 Î±2Ï2 Î±1Ï1 2 u22m + Î±2Ï2u22m (138)
Ï„dm = Î±2Ï2u22m Î±2Ï2 Î±1Ï1
+ 1
(139)
Ï„dm = Î±2Ï2u22m Î±2Ï2 + Î±1Ï1 Î±1Ï1 
(140)
Ï„dm = Î±2Ï2u22m  Ïm Î±1Ï1 
(141)
Ï„dm = Ïm Î±2 Î±1 Ï2 Ï1 u22m (142)
**å®ç°**
From the source code in Listing 310 we see the diffusion stress an the fourth term on the LHS of the momentum equation.
ä»æ¸…å•310ä¸­çš„æºä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰©æ•£åº”åŠ›å’ŒåŠ¨é‡æ–¹ç¨‹LHSä¸Šçš„ç¬¬å››é¡¹ã€‚
```
 fvVectorMatrix UEqn
 ( 3 fvm :: ddt ( rho , U)
 + fvm :: div ( rhoPhi , U)
 + MRF . DDt ( rho , U)
 + fvc :: div ( UdmModel . tauDm () )
 + turbulence -> divDevRhoReff (U)
 ==
 fvOptions ( rho , U)
 );
```
Listing 310: The momentum equation of driftFluxFoam
æ¸…å•310:driftFluxFoamçš„åŠ¨é‡æ–¹ç¨‹

Next, we take a look at the implementation of the diffusion stress.
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ‰©æ•£åº”åŠ›çš„å®ç°ã€‚
```
 tmp < volSymmTensorField > Foam :: relativeVelocityModel :: tauDm () const
 { 
	  volScalarField betac ( alphac_ * rhoc_ ) ;
	  volScalarField betad ( alphad_ * rhod_ ) ;
 // Calculate the relative velocity of the continuous phase w.r.t the mean
 volVectorField Ucm ( betad * Udm_ / betac );
 return tmp < volSymmTensorField >
 (
 new volSymmTensorField
 (
 " tauDm ",
 betad * sqr ( Udm_ ) + betac * sqr ( Ucm )
 )
 );
 }
```
Listing 311: The diffusion stress of driftFluxFoam computed by the relativeVelocityModel
æ¸…å•311:relativeVelocityModelè®¡ç®—çš„æ¼‚æµæ³¡æ²«çš„æ‰©æ•£åº”åŠ›

And now, we translate the source code into some math:
ç°åœ¨ï¼Œæˆ‘ä»¬å°†æºä»£ç è½¬åŒ–ä¸ºæ•°å­¦ï¼š
Ï„bm = Î²du2
dm + Î²cu2
cm (143)
withå’Œ
Î²d = Î±dÏd (144)
Î²c = Î±cÏc (145)
ucm = Î²d Î²c udm (146)
we gain æˆ‘ä»¬å¾—åˆ°
Ï„bm = Î²du2
dm + Î²c Î²d Î²c 2 u2
dm (147)
Ï„bm = Î²du2
dm 
1 +
Î²d Î²c 
(148)
Ï„bm = Î±dÏdu2
dm 
1 +
Î±dÏd Î±cÏc 
(149)
Ï„bm = Î±dÏdu2
dm Î±cÏc + Î±dÏd Î±cÏc 
(150)
Ï„bm = Î±dÏdu2
dm
Ïm Î±cÏc
(151)
Ï„bm = Ïm Î±d Î±c ÏdÏc u2
dm (152)
We notice, that (152) derived from the source code, equals (142), derived from literature  with phase 2 being the disperse phase d.
æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œï¼ˆ152ï¼‰æ¥è‡ªæºä»£ç ï¼Œç­‰äºï¼ˆ142ï¼‰ï¼Œæ¥è‡ªæ–‡çŒ®ï¼Œç¬¬2ç›¸æ˜¯åˆ†æ•£ç›¸dã€‚

**Relative velocity ç›¸å¯¹é€Ÿåº¦**
The diffusion velocity udm and the drift velocity udj are linked by a constitutive relation:
æ‰©æ•£é€Ÿåº¦udmå’Œæ¼‚ç§»é€Ÿåº¦udjé€šè¿‡æœ¬æ„å…³ç³»è¿æ¥ï¼š

udm = Ï1 Ïm udj (153)
We find this relation also in the source code in Listings 316 and 317. Ishii and Hibiki [31] state, that in the case of dispersed two-phase flow the drag correlation should be expressed in terms of the drift velocity udj .
The relative velocity models provide a method that returns udm, however, in the source code of the Listings 316 and 317 we find relation (153) translated into C++. There, the expression for udm consists of the density ratio and a relation for the drift velocity, which links the terminal velocity of a single particle and the volume fraction of the disperse phase.
æˆ‘ä»¬åœ¨æ¸…å•316å’Œ317ä¸­çš„æºä»£ç ä¸­ä¹Ÿå‘ç°äº†è¿™ç§å…³ç³»ã€‚Ishiiå’ŒHibiki[31]æŒ‡å‡ºï¼Œåœ¨åˆ†æ•£ä¸¤ç›¸æµçš„æƒ…å†µä¸‹ï¼Œé˜»åŠ›ç›¸å…³æ€§åº”è¯¥ç”¨æ¼‚ç§»é€Ÿåº¦udjè¡¨ç¤ºã€‚

ç›¸å¯¹é€Ÿåº¦æ¨¡å‹æä¾›äº†ä¸€ç§è¿”å›UDMçš„æ–¹æ³•ï¼Œä½†æ˜¯ï¼Œåœ¨æ¸…å•316å’Œ317çš„æºä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°å…³ç³»ï¼ˆ153ï¼‰è¢«ç¿»è¯‘æˆC++ã€‚åœ¨è¿™é‡Œï¼Œudmçš„è¡¨è¾¾å¼ç”±å¯†åº¦æ¯”å’Œæ¼‚ç§»é€Ÿåº¦çš„å…³ç³»å¼ç»„æˆï¼Œåè€…å°†å•ä¸ªç²’å­çš„æœ€ç»ˆé€Ÿåº¦ä¸åˆ†æ•£ç›¸çš„ä½“ç§¯åˆ†æ•°è”ç³»èµ·æ¥ã€‚

#### 48.2 incompressibleTwoPhaseInteractingMixture ä¸å¯å‹ç¼©ä¸¤ç›¸å¹²æ¶‰æ··åˆ
The class incompressibleTwoPhaseInteractingMixture serves as the transport model for driftFluxFoam. This class holds all the information of the two phases and provides the mixture quantities. driftFluxFoam solves the momentum and pressure equations for the mixture. Thus, this solver is in between a single-phase solver and a full two-fluid solver such as twoPhaseEulerFoam.  
ä¸å¯å‹ç¼©ä¸¤ç›¸ç›¸äº’ä½œç”¨æ··åˆç‰©æ˜¯æ¼‚æµæ³¡æ²«çš„è¾“è¿æ¨¡å‹ã€‚è¯¥ç±»ä¿å­˜ä¸¤ç›¸çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¹¶æä¾›æ··åˆç‰©çš„æ•°é‡ã€‚floftfluxfoamæ±‚è§£æ··åˆç‰©çš„åŠ¨é‡å’Œå‹åŠ›æ–¹ç¨‹ã€‚å› æ­¤ï¼Œè¯¥è§£ç®—å™¨ä½äºå•ç›¸è§£ç®—å™¨å’Œå…¨åŒæµä½“è§£ç®—å™¨ï¼ˆå¦‚twoPhaseEulerFoamï¼‰ä¹‹é—´ã€‚

Via this transport model, the mixture quantities propagate to the turbulence model, since the turbulence model receives a transport model class as template parameter at construction. This is one example for the versatility of the new, templated turbulence modelling framework. The precursor settlingFoam had a hardcoded k âˆ’  turbulence model. Also the viscosity model was kind of hard-coded.
é€šè¿‡æ­¤ä¼ è¾“æ¨¡å‹ï¼Œæ··åˆé‡ä¼ æ’­åˆ°æ¹æµæ¨¡å‹ï¼Œå› ä¸ºæ¹æµæ¨¡å‹åœ¨æ„å»ºæ—¶æ¥æ”¶ä¼ è¾“æ¨¡å‹ç±»ä½œä¸ºæ¨¡æ¿å‚æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªæ–°çš„æ¨¡æ¿æ¹æµå»ºæ¨¡æ¡†æ¶çš„å¤šåŠŸèƒ½æ€§çš„ä¾‹å­ã€‚å‰é©±ä½“æ²‰é™æ³¡æ²«å…·æœ‰ç¡¬ç¼–ç kâˆ’ æ¹æµæ¨¡å‹ã€‚ç²˜åº¦æ¨¡å‹ä¹Ÿæ˜¯ç¡¬ç¼–ç çš„ã€‚

#### 48.3 Mixture viscosity models æ··åˆç‰©ç²˜åº¦æ¨¡å‹
Settling equippment is often operated with solids concentrations at which the presence of the solid particles affect fluid properties. Besides using the mixture density, a mixture viscosity also has to be used.
æ²‰é™è®¾å¤‡é€šå¸¸åœ¨å›ºä½“æµ“åº¦ä¸‹è¿è¡Œï¼Œåœ¨æ­¤æµ“åº¦ä¸‹å›ºä½“é¢—ç²’çš„å­˜åœ¨ä¼šå½±å“æµä½“æ€§è´¨ã€‚é™¤äº†ä½¿ç”¨æ··åˆç‰©å¯†åº¦ï¼Œè¿˜å¿…é¡»ä½¿ç”¨æ··åˆç‰©ç²˜åº¦ã€‚

##### 48.3.1 mixtureViscosityModel æ··åˆç²˜åº¦æ¨¡å‹
The class mixtureViscosityModel is the abstract base class for the actual viscosity models. This class serves a similar purpose as the base class for the single-phase viscosity models viscosityModel located in $FOAM_SRC/transportModels/incompressible/viscosityModels/viscosityModel. These two base classes are rather similar and there are only slight differences in their implementations.

ç±»mixtureViscosityModelæ˜¯å®é™…ç²˜åº¦æ¨¡å‹çš„æŠ½è±¡åŸºç±»ã€‚æ­¤ç±»çš„ç”¨é€”ä¸$FOAMÃ¯SRC/transportModels/incompressible/viscosityModels/viscosityModelä¸­å•ç›¸ç²˜åº¦æ¨¡å‹viscosityModelçš„åŸºç±»ç±»ä¼¼ã€‚è¿™ä¸¤ä¸ªåŸºç±»éå¸¸ç›¸ä¼¼ï¼Œå®ƒä»¬çš„å®ç°åªæœ‰ç»†å¾®çš„å·®åˆ«ã€‚

##### 48.3.2 slurry æ³¥æµ†
The slurry mixture viscosity model is a correction for the Newtonian viscosity with reference to Thomas [60].
æ³¥æµ†æ··åˆç‰©ç²˜åº¦æ¨¡å‹æ˜¯å‚è€ƒæ‰˜é©¬æ–¯[60]å¯¹ç‰›é¡¿ç²˜åº¦çš„ä¿®æ­£ã€‚

(154)
The source code computing the mixture viscosity is a direct translation of the math above into C++.
è®¡ç®—æ··åˆç²˜åº¦çš„æºä»£ç æ˜¯å°†ä¸Šè¿°æ•°å­¦ç›´æ¥è½¬åŒ–ä¸ºC++ã€‚

```
 Foam :: tmp < Foam :: volScalarField >
 Foam :: mixtureViscosityModels :: slurry :: mu ( const volScalarField & muc ) const
 { 
	  return
 ( 
	  muc *(1.0 + 2.5* alpha_ + 10.05* sqr ( alpha_ ) + 0.00273* exp (16.6* alpha_ ))
 );
 }
```
Listing 312: The calculation of the mixture viscosity by the slurry mixture viscosity model
æ¸…å•312ï¼šé€šè¿‡æ³¥æµ†æ··åˆç‰©ç²˜åº¦æ¨¡å‹è®¡ç®—æ··åˆç‰©ç²˜åº¦

##### 48.3.3 plastic
The plastic viscosity model is based on a generic viscosity model (155) for liquids exhibiting plastic behaviour.
å¡‘æ€§ç²˜åº¦æ¨¡å‹åŸºäºè¡¨ç°å‡ºå¡‘æ€§è¡Œä¸ºçš„æ¶²ä½“çš„é€šç”¨ç²˜åº¦æ¨¡å‹ï¼ˆ155ï¼‰ã€‚

Ï„ = aCb Î± (155)
The plastic model implemented in driftFluxFoam translates to:
åœ¨driftFluxFoamä¸­å®ç°çš„å¡‘æ–™æ¨¡å‹å¯è½¬æ¢ä¸ºï¼š

Âµ = min [Âµc + k âˆ— (10n Î± âˆ’ 1), Âµmax] (156)
Listing 313 shows the source code computing the mixture viscosity. The -1 in the second term ensures, that we retain the laminar viscosity of the continuous phase in the case the dispersed volume fraction vanishes, since anything to the power of zero equals one.
æ¸…å•313æ˜¾ç¤ºäº†è®¡ç®—æ··åˆç‰©ç²˜åº¦çš„æºä»£ç ã€‚ç¬¬äºŒé¡¹ä¸­çš„-1ç¡®ä¿åœ¨åˆ†æ•£ä½“ç§¯åˆ†æ•°æ¶ˆå¤±çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¿æŒè¿ç»­ç›¸çš„å±‚æµç²˜åº¦ï¼Œå› ä¸ºä»»ä½•0çš„å¹‚ç­‰äº1ã€‚


```
Foam :: tmp < Foam :: volScalarField >
 Foam :: mixtureViscosityModels :: plastic :: mu ( const volScalarField & muc ) const
 { 
	  return min
 ( 
	  muc
 + plasticViscosityCoeff_
 *(
 pow
 (
 scalar (10) ,
 plasticViscosityExponent_ * alpha_
 ) - scalar (1)
 ) ,
 muMax_
 );
 }
```
Listing 313: The calculation of the mixture viscosity by the plastic mixture viscosity model.
æ¸…å•313ï¼šç”¨å¡‘æ–™æ··åˆç‰©ç²˜åº¦æ¨¡å‹è®¡ç®—æ··åˆç‰©ç²˜åº¦ã€‚

##### 48.3.4 BinghamPlastic
BinghamPlastic is a Bingham plastic model.
å®¾æ±‰å¡‘æ–™æ˜¯å®¾æ±‰å¡‘æ–™æ¨¡å‹ã€‚

#### 48.4 Relative velocity models - hindered settling ç›¸å¯¹é€Ÿåº¦æ¨¡å‹-å—é˜»æ²‰é™
In this section we use the symbol v for the velocity to follow the notation of Brennan [12] as well as the source code of OpenFOAM.
åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¦å·vè¡¨ç¤ºé€Ÿåº¦ï¼Œä»¥éµå¾ªBrennan[12]çš„è¡¨ç¤ºæ³•ä»¥åŠOpenFOAMçš„æºä»£ç ã€‚

##### 48.4.1 The base class åŸºç±»
The base class holds the data common to the derived models. The base class holds the private field Udm_ for the diffusion velocity udm and declares an abstract method correct(). The method correct() is used by the derived classes to compute the diffusion velocity Udm_.
åŸºç±»ä¿å­˜æ´¾ç”Ÿæ¨¡å‹çš„å…¬å…±æ•°æ®ã€‚åŸºç±»ä¿å­˜æ‰©æ•£é€Ÿåº¦Udmçš„ç§æœ‰å­—æ®µUdm_uï¼Œå¹¶å£°æ˜ä¸€ä¸ªæŠ½è±¡æ–¹æ³•correctï¼ˆï¼‰ã€‚æ´¾ç”Ÿç±»ä½¿ç”¨correctï¼ˆï¼‰æ–¹æ³•æ¥è®¡ç®—æ‰©æ•£é€Ÿåº¦Udmã€‚

The method Udm() of the base class simply returns Udm_, and the method tauDm() returns the diffusion stress computed from the diffusion velocity.
åŸºç±»çš„æ–¹æ³•Udmï¼ˆï¼‰ç®€å•åœ°è¿”å›Udmï¼Œæ–¹æ³•tauDmï¼ˆï¼‰è¿”å›ç”±æ‰©æ•£é€Ÿåº¦è®¡ç®—å‡ºçš„æ‰©æ•£åº”åŠ›ã€‚

**The diffusion velocity æ‰©æ•£é€Ÿåº¦**
The class for the relative velocity model holds a vector field for the diffusion velocity. The internal field values are determined from the actual model in use, however, the boundary conditions are taken over from the mixture velocity field.
This, we can read from the source code of the base class. In Listing 314 we see the initializer responsible for the diffusion velocity.
ç›¸å¯¹é€Ÿåº¦æ¨¡å‹çš„ç±»åŒ…å«æ‰©æ•£é€Ÿåº¦çš„å‘é‡åœºã€‚å†…éƒ¨åœºå€¼æ˜¯æ ¹æ®å®é™…ä½¿ç”¨çš„æ¨¡å‹ç¡®å®šçš„ï¼Œä½†æ˜¯è¾¹ç•Œæ¡ä»¶æ˜¯ä»æ··åˆé€Ÿåº¦åœºä¸­è·å–çš„ã€‚

è¿™ï¼Œæˆ‘ä»¬å¯ä»¥ä»åŸºç±»çš„æºä»£ç ä¸­è¯»å–ã€‚åœ¨æ¸…å•314ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è´Ÿè´£æ‰©æ•£é€Ÿåº¦çš„åˆå§‹å€¼è®¾å®šé¡¹ã€‚

```
 Udm_
 ( 
	  IOobject
 ( 
	 " Udm ", 6 alphac_ . time () . timeName () ,
 alphac_ . mesh () ,
 IOobject :: NO_READ ,
 IOobject :: AUTO_WRITE
 ) ,
 alphac_ . mesh () ,
 dimensionedVector (" Udm", dimVelocity , vector :: zero ) ,
 mixture .U () . boundaryField () . types ()
 )
```
Listing 314: The initializer entry for Udm_ in the constructor of the relativeVelocityModel class.
æ¸…å•314:relativeVelocityModelç±»çš„æ„é€ å‡½æ•°ä¸­Udm\çš„åˆå§‹å€¼è®¾å®šé¡¹ã€‚

For the interpretation of Listing 314 we need to dig out the appropriate constructor of the class GeometricField139. In Listing 315 we see that the constructor receives five arguments, of which the last has a default value. If we pass only four arguments, the fifth will be determined from the default value.
ä¸ºäº†è§£é‡Šæ¸…å•314ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºGeometricField139ç±»çš„ç›¸åº”æ„é€ å‡½æ•°ã€‚åœ¨æ¸…å•315ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æ„é€ å‡½æ•°æ¥æ”¶äº”ä¸ªå‚æ•°ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°æœ‰ä¸€ä¸ªé»˜è®¤å€¼ã€‚å¦‚æœæˆ‘ä»¬åªä¼ é€’å››ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆç¬¬äº”ä¸ªå‚æ•°å°†ç”±é»˜è®¤å€¼ç¡®å®šã€‚

```
 // - Constructor given IOobject , mesh , dimensioned <Type > and patch types . 
  GeometricField
 ( 
	  const IOobject &,
 const Mesh &,
 const dimensioned < Type >& ,
 const wordList & wantedPatchTypes ,
 const wordList & actualPatchTypes = wordList ()
 );
```
Listing 315: The signature of the constructor called by the code in Listing 314.
æ¸…å•315ï¼šæ¸…å•314ä¸­ä»£ç è°ƒç”¨çš„æ„é€ å‡½æ•°çš„ç­¾åã€‚

If we compare the arguments of the constructor call of Listing 314 and the signature in Listing 315, we see that the first argument passed is clearly an IOobject. The second argument is a reference to the mesh itself, which is obvious from the call to alphac_.mesh() in Listing 314.
å¦‚æœæˆ‘ä»¬æ¯”è¾ƒæ¸…å•314çš„æ„é€ å‡½æ•°è°ƒç”¨çš„å‚æ•°å’Œæ¸…å•315ä¸­çš„ç­¾åï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¾ç„¶æ˜¯ä¸€ä¸ªIOobjectã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯¹meshæœ¬èº«çš„å¼•ç”¨ï¼Œä»æ¸…å•314ä¸­å¯¹alphac\.meshï¼ˆï¼‰çš„è°ƒç”¨ä¸­å¯ä»¥æ˜æ˜¾çœ‹å‡ºè¿™ä¸€ç‚¹ã€‚

The third argument determines the type of the field as well as the initial value. The template parameter Type determines whether the field is a scalar, a vector or a tensor field. As a dimensionedVector is passed in Listing 314, Type evaluates to vector140.
ç¬¬ä¸‰ä¸ªå‚æ•°ç¡®å®šå­—æ®µçš„ç±»å‹ä»¥åŠåˆå§‹å€¼ã€‚æ¨¡æ¿å‚æ•°ç±»å‹ç¡®å®šå­—æ®µæ˜¯æ ‡é‡å­—æ®µã€å‘é‡å­—æ®µè¿˜æ˜¯å¼ é‡å­—æ®µã€‚å½“æ¸…å•314ä¸­ä¼ é€’ä¸€ä¸ªdimensionedVectoræ—¶ï¼Œç±»å‹çš„è®¡ç®—ç»“æœä¸ºvector140ã€‚

The fourth argument is a list of patch types, since we passed only one dimensioned value as the third argument, there has been no information passed on the boundary conditions of the field up to now. By passing the list of boundary types of the mixture velocity field (mixture.U()), the boundary conditions of the field Udm_ are specified.
ç¬¬å››ä¸ªå‚æ•°æ˜¯é¢ç‰‡ç±»å‹çš„åˆ—è¡¨ï¼Œå› ä¸ºæˆ‘ä»¬åªä¼ é€’äº†ä¸€ç»´å€¼ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥åˆ°ç›®å‰ä¸ºæ­¢è¿˜æ²¡æœ‰ä¼ é€’å…³äºåœºçš„è¾¹ç•Œæ¡ä»¶çš„ä¿¡æ¯ã€‚é€šè¿‡ä¼ é€’æ··åˆé€Ÿåº¦åœºçš„è¾¹ç•Œç±»å‹åˆ—è¡¨ï¼ˆmixture.Uï¼ˆï¼‰ï¼‰ï¼ŒæŒ‡å®šäº†åœºUdm_2;çš„è¾¹ç•Œæ¡ä»¶ã€‚

As there is no fifth argument passed in Listing 314, the return value of the call wordList() is used.
ç”±äºæ¸…å•314ä¸­æ²¡æœ‰ä¼ é€’ç¬¬äº”ä¸ªå‚æ•°ï¼Œå› æ­¤ä½¿ç”¨äº†call wordListï¼ˆï¼‰çš„è¿”å›å€¼ã€‚

##### 48.4.2 simpleæ¨¡å‹
The model named simple is similar to the model used by Brennan [12] with attribution to Dahl [17]. This model is very similar to the Vesilind [65] model (158), Brennan [12] explains the change of the base from the Euler number e to the base 10 with a closer fit to experimental data gathered by Dahl [17].
åä¸ºsimpleçš„æ¨¡å‹ç±»ä¼¼äºBrennan[12]ä½¿ç”¨çš„æ¨¡å‹ï¼Œå½’å› äºDahl[17]ã€‚è¯¥æ¨¡å‹ä¸Vesilind[65]æ¨¡å‹ï¼ˆ158ï¼‰éå¸¸ç›¸ä¼¼ï¼ŒBrennan[12]è§£é‡Šäº†åŸºæ•°ä»Euleræ•°eåˆ°åŸºæ•°10çš„å˜åŒ–ï¼Œæ›´æ¥è¿‘Dahl[17]æ”¶é›†çš„å®éªŒæ•°æ®ã€‚
vs = v0 10âˆ’kÎ± (157)
The implementation of the simple model is more or less a direct translation from math (157) to C++. In the exponent the maximum of the dispersed volume fraction and zero is taken to avoid numerical trouble from negative values of the volume fraction. Reversing the sign in an exponent is never a good idea in numerical simulation.
ç®€å•æ¨¡å‹çš„å®ç°æˆ–å¤šæˆ–å°‘æ˜¯ç›´æ¥ä»æ•°å­¦ï¼ˆ157ï¼‰åˆ°C++çš„è½¬æ¢ã€‚åœ¨æŒ‡æ•°ä¸­å–ç¦»æ•£ä½“ç§¯åˆ†æ•°çš„æœ€å¤§å€¼å’Œé›¶ï¼Œé¿å…äº†ä½“ç§¯åˆ†æ•°è´Ÿå€¼å¸¦æ¥çš„æ•°å€¼éº»çƒ¦ã€‚åœ¨æ•°å€¼æ¨¡æ‹Ÿä¸­ï¼Œåè½¬æŒ‡æ•°çš„ç¬¦å·ä»æ¥ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚

```
 void Foam :: relativeVelocityModels :: simple :: correct ()
 { 
	  Udm_ = ( rhoc_ / rho () )* V0_ * pow ( scalar (10) , -a_ * max ( alphad_ , scalar (0) )) ;
 }
```
Listing 316: The calculation of the dispersed diffusion velocity Udm_ by the simple relative velocity
æ¸…å•316ï¼šé€šè¿‡ç®€å•ç›¸å¯¹é€Ÿåº¦è®¡ç®—å¼¥æ•£æ‰©æ•£é€Ÿåº¦Udm

##### 48.4.3 generalæ¨¡å‹
The model referred to as general is most probably basedon the model of TakÃ¡cs [59], there is no reference to any literature in the header file. The TakÃ¡cs [59] model (159) is a so-called double-exponential model based on the model of Vesilind [65], see (158) [28, 12].
è¢«ç§°ä¸ºgeneralçš„æ¨¡å‹å¾ˆå¯èƒ½æ˜¯åŸºäºTakÃ¡csçš„æ¨¡å‹[59]ï¼Œå¤´æ–‡ä»¶ä¸­æ²¡æœ‰å¼•ç”¨ä»»ä½•æ–‡çŒ®ã€‚TakÃ¡cs[59]æ¨¡å‹ï¼ˆ159ï¼‰æ˜¯åŸºäºVesilind[65]æ¨¡å‹çš„æ‰€è°“åŒæŒ‡æ•°æ¨¡å‹ï¼Œè§ï¼ˆ158ï¼‰[28ï¼Œ12]ã€‚

vs = v0 eâˆ’nX (158)
vs = v0 

with
vs settling velocity
v0 maximum settling velocity
n model parameter
rh settling parameter for hindered settling
rp settling parameter for low solids concentration
X suspended solids concentration
vsæ²‰é™é€Ÿåº¦

v0æœ€å¤§æ²‰é™é€Ÿåº¦

næ¨¡å‹å‚æ•°

é˜»ç¢æ²‰é™çš„rhæ²‰é™å‚æ•°

ä½å›ºç›¸æµ“åº¦ä¸‹çš„rpæ²‰é™å‚æ•°

Xæ‚¬æµ®å›ºä½“æµ“åº¦
(160)

The implementation .
å®ç°å¦‚ä¸‹ï¼š
```
 void Foam :: relativeVelocityModels :: general :: correct ()
 { 
	  Udm_ =
 ( rhoc_ / rho () )
 * V0_
 *(
 exp (- a_ * max ( alphad_ - residualAlpha_ , scalar (0) ))
 - exp (- a1_ * max ( alphad_ - residualAlpha_ , scalar (0) ))
 );
 }
```
Listing 317: The calculation of the dispersed diffusion velocity Udm_ by the general relative velocity model.
æ¸…å•317ï¼šç”¨ä¸€èˆ¬ç›¸å¯¹é€Ÿåº¦æ¨¡å‹è®¡ç®—å¼¥æ•£æ‰©æ•£é€Ÿåº¦Udmã€‚

#### 48.5 settlingFoam
Here we take a closer look on settlingFoam (of OpenFOAM-2.2.x), which is the predecessor of driftFluxFoam. By comparing the implementations of these two solvers we can observe the transition of the OpenFOAM source code base to a more encapsulated approach.
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ›´ä»”ç»†åœ°äº†è§£æ²‰é™æ³¡æ²«ï¼ˆOpenFOAM-2.2.xçš„ç‰ˆæœ¬ï¼‰ï¼Œå®ƒæ˜¯floftfluxfoamçš„å‰èº«ã€‚é€šè¿‡æ¯”è¾ƒè¿™ä¸¤ä¸ªè§£ç®—å™¨çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°OpenFOAMæºä»£ç åº“å‘æ›´å°è£…çš„æ–¹æ³•çš„è½¬å˜ã€‚

##### 48.5.1 Mixture viscosity æ··åˆç‰©ç²˜åº¦
settlingFoam was/is restricted to the plastic or Bingham viscosity models. Listing 318 shows the code of settlingFoam, which computes the mixture viscosity. This code is located in a source file, which is included into the body of the PIMPLE loop of the solver.

æ²‰é™æ³¡æ²«ä»…é™äºå¡‘æ–™æˆ–å®¾æ±‰ç²˜åº¦æ¨¡å‹ã€‚æ¸…å•318æ˜¾ç¤ºäº†æ²‰é™æ³¡æ²«çš„ä»£ç ï¼Œå®ƒè®¡ç®—æ··åˆç‰©çš„ç²˜åº¦ã€‚æ­¤ä»£ç ä½äºæºæ–‡ä»¶ä¸­ï¼Œæºæ–‡ä»¶åŒ…å«åœ¨è§£ç®—å™¨çš„PIMPLEå¾ªç¯ä½“ä¸­ã€‚
Thus, for this solver, the treatment of mixture viscosity is not encapsulated. The viscosity models are not located in separate files and the code of the solver itself contains all the knowledge of the viscosity models. Extending the solver with one or more mixture viscosity models would entail building an extended if-cascade within the file correctViscosity.H.
å› æ­¤ï¼Œå¯¹äºè¯¥è§£ç®—å™¨ï¼Œä¸å°è£…æ··åˆç‰©ç²˜åº¦çš„å¤„ç†ã€‚ç²˜åº¦æ¨¡å‹ä¸åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œæ±‚è§£å™¨æœ¬èº«çš„ä»£ç åŒ…å«ç²˜åº¦æ¨¡å‹çš„æ‰€æœ‰çŸ¥è¯†ã€‚ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªæ··åˆç²˜åº¦æ¨¡å‹æ‰©å±•è§£ç®—å™¨éœ€è¦åœ¨correctVisity.Hæ–‡ä»¶ä¸­æ„å»ºæ‰©å±•çš„ifçº§è”ã€‚

```
 { 
	  /* compute plastic viscosity */
 mul = muc +
 plasticViscosity
 ( 
	  /* code removed for brevity */
 );
 if ( BinghamPlastic )
 {
 volScalarField tauy = yieldStress
 (
 /* see yieldStress .H */
 );
 mul =
 /* compute contribution of yield stress */
 + mul ;
 }

 mul = min ( mul , muMax ) ;
 }
```
Listing 318: The calculation of the mixture viscosity in the file correctViscosity.H of settlingFoam of OpenFOAM-2.2.x. Comments added by the author.
æ¸…å•318:OpenFOAM-2.2.xçš„settingfoamæ–‡ä»¶correctVisity.Hä¸­æ··åˆç‰©ç²˜åº¦çš„è®¡ç®—ã€‚ä½œè€…è¡¥å……çš„è¯„è®ºã€‚

##### 48.5.2 Relative velocity models ç›¸å¯¹é€Ÿåº¦æ¨¡å‹
settlingFoam of OpenFOAM-2.2.x offers the same choice of relative velocity models as driftFluxFoam at the time of writing. However, implementation-wise we note, that model selection is, again, done in an if-statement cascade.
åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒOpenFOAM-2.2.xçš„æ²‰é™æ³¡æ²«æä¾›äº†ä¸driftFluxFoamç›¸åŒçš„ç›¸å¯¹é€Ÿåº¦æ¨¡å‹é€‰æ‹©ã€‚ç„¶è€Œï¼Œåœ¨å®ç°æ–¹é¢ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæ¨¡å‹é€‰æ‹©åŒæ ·æ˜¯åœ¨ifè¯­å¥çº§è”ä¸­å®Œæˆçš„ã€‚

```
 if ( VdjModel == " general ") 
  { 
	   Vdj = V0 *
 ( 
	  exp (-a * max ( alpha - alphaMin , scalar (0) ))
 - exp (- a1 * max ( alpha - alphaMin , scalar (0) ))
 );
  } 
   else if ( VdjModel == " simple ")
 {
 Vdj = V0 * pow (10.0 , -a * alpha );
 }
 else
 {
 FatalErrorIn ( args . executable () )
 << " Unknown VdjModel : " << VdjModel
 << abort ( FatalError ) ;
 }

 Vdj . correctBoundaryConditions () ;
```
Listing 319: The calculation of the relative velocity in the file calcVdj.H of settlingFoam of OpenFOAM-2.2.x.
æ¸…å•319:OpenFOAM-2.2.xçš„æ–‡ä»¶calcVdj.Hä¸­æ²‰é™æ³¡æ²«çš„ç›¸å¯¹é€Ÿåº¦çš„è®¡ç®—ã€‚

##### 48.5.3 Turbulence æ¹æµ
Turbulence in settlingFoam was/is implemented in a similar fashion as in twoPhaseEulerFoam of that time. Both solvers feature a hard-coded k âˆ’  turbulence model, which is adapted to the solvers needs.
æ²‰é™æ³¡æ²«ä¸­çš„æ¹æµä»¥ä¸å½“æ—¶çš„ä¸¤ç›¸è§„åˆ™æ³¡æ²«ç›¸ä¼¼çš„æ–¹å¼å®ç°ã€‚ä¸¤ä¸ªè§£ç®—å™¨éƒ½å…·æœ‰ç¡¬ç¼–ç çš„kâˆ’ æ¹æµæ¨¡å‹ï¼Œé€‚åˆè§£ç®—å™¨çš„éœ€è¦ã€‚