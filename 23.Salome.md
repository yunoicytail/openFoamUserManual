### 22  Salome

The Salome platform is a powerful multitool, which features a meshing module. This meshing module offers a number of meshing tools.

#### 23.1 Export & Conversion

Meshes can be exported by Salome into several formats. The go-to procedure for OpenFOAM-use is to export the mesh in the UNV format and use the ideasUnvToFoam mesh converter.

##### 23.1.1 Salome’s native UNV export

However, there is an issue when using the UNV format. Apparently, see Figure 47, Salome’s mesh export tool for the UNV format does not export pyramid cells.

![图像47](images/47.png)\
Figure 47: Mesh export issue in Salome with the UNV format.

##### 23.1.2 salomeToOpenFOAM
A third-party Python script56 can be used to export a mesh containing pyramid cells to OpenFOAM. This script directly writes the essential files57. In order to export a mesh, simply select it in the Object Browser of Salome and then execute the salomeToOpenFOAM.py Python script. This can be done by using File Load Script menu.

##### 23.1.3 Pitfall: Check your patches/patch types
In Salome we are able to define patches by creating face groups. These face groups are translated to patches, when exporting the mesh. However, Salome has no way to distinguish between general patches and wall patches. Thus, you may want to check constant/polyMesh/boundary for the patch types.
    With Salome’s native export to UNV function, all patches are equal. After importing with OpenFOAM’s native ideasUnvToFoam converter all patches are of the type patch. You need to take care yourself, to assign the type wall to wall patches58. This can be done manually or with the tool changeDictionary. See Section 30.1 for more information on changeDictionary and an example of how to change the patch type.
    The third party conversion script salomeToOpenFOAM.py makes all patches wall patches, when their names
contain the word wall. 
```
1 if " wall " in gname . lower () :
2 fileBoundary . write (" wall ;\n") 
3 else : 
4 fileBoundary . write (" patch ;\n")
```
Listing 149: Determining the patch type in salomeToOpenFOAM.py.

#### 23.2 Combined operations: blockMesh & salome

##### 23.2.1 Motivation

Figure 48 shows a simulation domain with a comparatively small geometric feature. If we were to create a blockMesh-mesh for this geometry we end up with plenty of rather useless fine cells next to that fine feature, as can seen in Figure 49. Note that in Figure 49 we even can not make out individual cells, or even the cut-out slot in the center.

![图像48](images/48.png)\
Figure 48: A big simulation domain with a quite small geometric feature: the geometry
![图像49](images/49.png)\
Figure 49: A big simulation domain with a quite small geometric feature: the blockMesh-only mesh.

##### 23.2.2 Workflow

An alternative to an outcome as shown in Figure 49, we could choose to create a bigger central block which encompasses the cut-out slot, instead of representing the cut-out. This cut-out block will remain a part of the mesh, and then we will split the mesh into the cut-out block and the remaining mesh.
    Then, we create a geometry representation of the cut-out block with the cut-out slot in Salome. When, we mesh the cut-out block, we follow this workflow.
1. Create groups on the geometry: the sides, the front face and the inner edges
2. Import the surface mesh from the meshed cut-out block, as shown in Figure 50
3. Mesh the geometry with the following sub-meshes, preferably in this order
	(a) The sides with the “Import 1D-2D Elements from Another Mesh” algorithm
	(b) The inner edges with a suitable 1D algorithm
	(c) The front face with a suitable 2D algorithm
	(d) The geometry with the “Extrusion 3D” algorithm
	
Figure 51 shows the mesh, which we created in Salome.

![图像50](images/50.png)\
Figure 50: The mesh of the cut-out block in salome.
![图像51](images/51.png)\
Figure 51: Meshing of a block in salome.

Finally, we need to export our mesh from Salome into OpenFOAM, and combine it with the mesh of the remaining domain. Figure 52 shows the result of our procedure. Thus, we are able to create a relatively fine mesh around the fine geometric feature, without the mesh fine-ness spreading out along the principal directions as in the example shown in Figure 49.

![图像52](images/52.png)\
Figure 52: Combining blockMesh and salome: the meshed block was re-combined with the initial mesh.